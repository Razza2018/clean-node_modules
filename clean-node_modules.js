const fs = require('fs');

function clean() {
  const path = '..';
  var folders = fetchFolders(path);

  if (!folders || !folders.length) return;

  deleteFolders(folders);

  console.log(folders);
}

function fetchFolders(path) {
  var folders = fs.readdirSync(path);

  return folders.reduce((accumulator, folder) => {
    let folderPath = `${path}/${folder}/node_modules`;

    if (fs.existsSync(folderPath)) {
      accumulator.push(fs.realpathSync(folderPath));
    }

    return accumulator;
  }, []);
}

function deleteFolders(folders) {
  for (let folder of folders) {
    fs.rmSync(folder, {recursive: true});
  }
}

clean();
